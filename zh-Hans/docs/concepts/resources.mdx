---
title: "资源"
description: "从您的服务器向 LLMs 暴露数据和内容"
---

资源是 Model Context Protocol (MCP) 中的一个核心原语，允许服务器暴露可以被客户端读取并用作 LLM 交互上下文的数据和内容。

<Note>
  资源被设计为**应用程序控制**，这意味着客户端应用程序可以决定如何以及何时使用它们。
</Note>

## 资源是什么？

资源代表服务器可以提供给客户端的任何数据或内容。这可以包括：

- 文件系统中的文件
- 数据库中的记录
- API 响应
- 生成的内容
- 流式数据
- 二进制数据

每个资源都有一个唯一的 URI 和相关的元数据，如 MIME 类型和大小。

## 资源 URI

资源通过 URI 模板进行标识和访问。URI 模板提供了一种灵活的方式来定义资源位置和参数：

```json
{
  "uri": "file://{path}",
  "name": "文件系统",
  "description": "访问本地文件系统",
  "mimeType": "*/*"
}
```

客户端通过提供必要的参数来解析这些模板：

```json
{
  "uri": "file:///path/to/document.txt",
  "parameters": {
    "path": "/path/to/document.txt"
  }
}
```

## 资源发现

服务器通过 `listResources` 方法公开可用的资源。这返回资源定义的列表，包括：

- URI 模板
- 名称和描述
- MIME 类型
- 参数模式

客户端可以使用此信息来发现可用资源并了解如何访问它们。

## 读取资源

一旦发现了资源，客户端就可以使用 `readResource` 方法检索其内容：

<CodeGroup>
```typescript TypeScript
const result = await client.readResource({
  uri: "file:///path/to/document.txt"
});

console.log(result.contents); // 文件内容
```

```python Python
result = client.read_resource(
    uri="file:///path/to/document.txt"
)

print(result.contents) # 文件内容
```
</CodeGroup>

资源内容作为字符串或二进制数据返回，具体取决于资源类型。

## 资源变更通知

服务器可以通知客户端资源列表的变更：

```json
{
  "jsonrpc": "2.0",
  "method": "resources/changed",
  "params": {
    "added": [
      {
        "uri": "file://{path}",
        "name": "新资源"
      }
    ],
    "removed": [
      "old-resource://"
    ]
  }
}
```

这使客户端能够保持其资源视图的最新状态。

## 实现资源

要在您的服务器中实现资源支持：

1. 定义资源 URI 模板
2. 实现资源发现
3. 处理资源读取请求
4. 发送变更通知（可选）

示例实现：

<CodeGroup>
```typescript TypeScript
const fileResource = {
  uri: "file://{path}",
  name: "文件系统",
  description: "访问本地文件系统",
  mimeType: "*/*",
  parameters: {
    path: { type: "string" }
  }
};

server.addResource(fileResource, async (request) => {
  const contents = await fs.readFile(request.parameters.path);
  return { contents };
});
```

```python Python
file_resource = Resource(
    uri="file://{path}",
    name="文件系统",
    description="访问本地文件系统",
    mime_type="*/*",
    parameters={"path": {"type": "string"}}
)

@server.resource(file_resource)
async def handle_file(request):
    contents = await read_file(request.parameters["path"])
    return ResourceResponse(contents=contents)
```
</CodeGroup>

## 最佳实践

实现资源时要考虑：

- 仔细验证资源参数
- 实现适当的错误处理
- 考虑性能和缓存
- 正确设置 MIME 类型
- 处理大文件
- 实现超时
- 限制资源大小
- 保护敏感数据

## 安全考虑

在实现资源时要注意以下安全方面：

- 净化文件路径以防止目录遍历
- 谨慎处理二进制数据
- 考虑资源读取的速率限制
- 审计资源访问
- 加密传输中的敏感数据
- 验证 MIME 类型
- 为长时间运行的读取实现超时
- 适当处理资源清理 