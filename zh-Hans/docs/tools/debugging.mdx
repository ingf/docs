---
title: 调试
description: Model Context Protocol (MCP) 集成的全面调试指南
---

在开发 MCP 服务器或将其与应用程序集成时,有效的调试是必不可少的。本指南涵盖了 MCP 生态系统中可用的调试工具和方法。

<Info>
  本指南适用于 macOS。其他平台的指南即将推出。
</Info>

## 调试工具概述

MCP 提供了几个用于不同层面调试的工具:

1. **MCP Inspector**
   - 交互式调试界面
   - 直接服务器测试
   - 查看 [Inspector 指南](/docs/tools/inspector) 了解详情

2. **命令行工具**
   - 快速测试和验证
   - 自动化测试支持
   - 持续集成工作流

3. **SDK 调试工具**
   - 详细的日志记录
   - 请求/响应跟踪
   - 性能分析

## 常见问题

### 连接问题

1. **检查清单**
   - 验证服务器是否正在运行
   - 确认端口配置
   - 检查防火墙设置
   - 验证网络连接

2. **诊断步骤**
   - 启用详细日志记录
   - 检查错误消息
   - 验证配置
   - 测试基本连接

### 协议错误

1. **常见原因**
   - 版本不匹配
   - 无效的消息格式
   - 缺少必需字段
   - 类型错误

2. **解决方法**
   - 检查协议版本
   - 验证消息结构
   - 使用模式验证
   - 检查数据类型

### 性能问题

1. **识别瓶颈**
   - 监控响应时间
   - 检查资源使用
   - 分析网络延迟
   - 评估内存使用

2. **优化策略**
   - 实现缓存
   - 优化查询
   - 减少网络往返
   - 管理资源清理

## 调试工具

### MCP Inspector

1. **基本用法**
   ```bash
   npx @modelcontextprotocol/inspector
   ```

2. **常见命令**
   ```bash
   # 连接到服务器
   inspector connect ws://localhost:8080

   # 列出可用工具
   inspector tools list

   # 调用工具
   inspector tools call <tool-name>
   ```

### 日志记录

1. **启用调试日志**
   ```typescript
   const server = new Server({
     debug: true,
     logLevel: "debug"
   });
   ```

2. **日志级别**
   - ERROR: 错误和失败
   - WARN: 警告和问题
   - INFO: 一般信息
   - DEBUG: 详细调试信息
   - TRACE: 最详细的跟踪

## 最佳实践

1. **开发环境**
   - 使用开发模式
   - 启用详细日志记录
   - 实现错误处理
   - 设置断点

2. **测试策略**
   - 编写单元测试
   - 执行集成测试
   - 模拟依赖项
   - 测试错误情况

3. **故障排除**
   - 系统地隔离问题
   - 收集相关日志
   - 复现问题
   - 记录解决方案

## 报告问题

在报告问题时:

1. **问题描述**
   - 清晰描述问题
   - 提供复现步骤
   - 包含预期行为
   - 描述实际结果

2. **系统信息**
   - MCP 版本
   - 操作系统
   - 运行时环境
   - 相关依赖

3. **提供信息**
   - 日志摘录
   - 配置文件
   - 复现步骤
   - 环境详情

## 下一步

<CardGroup cols={2}>
  <Card
    title="MCP Inspector"
    icon="magnifying-glass"
    href="/docs/tools/inspector"
  >
    学习使用 MCP Inspector
  </Card>
</CardGroup> 